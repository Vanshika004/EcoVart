{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Vanshika/Desktop/Ecocart/lib/orders.js"],"sourcesContent":["// lib/orders.js\r\nimport {\r\n  collection,\r\n  addDoc,\r\n  serverTimestamp,\r\n  query,\r\n  where,\r\n  orderBy,\r\n  getDocs,\r\n} from \"firebase/firestore\";\r\nimport { db } from \"./firebase\";\r\n\r\n// Place user's order\r\nexport async function placeOrderForUser(uid, orderPayload) {\r\n  if (!uid) throw new Error(\"Missing uid\");\r\n\r\n  const ordersCol = collection(db, \"orders\");\r\n\r\n  const payload = {\r\n    userId: uid,\r\n    items: Array.isArray(orderPayload.items) ? orderPayload.items : [],\r\n    total: orderPayload.total || 0,\r\n    footprintEstimate: orderPayload.footprintEstimate || null,\r\n    status: \"placed\",\r\n    createdAt: serverTimestamp(),\r\n  };\r\n\r\n  const ref = await addDoc(ordersCol, payload);\r\n  return { id: ref.id, data: payload };\r\n}\r\n\r\n// Fetch user's orders\r\nexport async function fetchOrdersForUser(uid) {\r\n  if (!uid) return [];\r\n\r\n  const q = query(\r\n    collection(db, \"orders\"),\r\n    where(\"userId\", \"==\", uid),\r\n    orderBy(\"createdAt\", \"desc\")\r\n  );\r\n\r\n  const snaps = await getDocs(q);\r\n  return snaps.docs.map((d) => ({ id: d.id, data: d.data() }));\r\n}\r\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;;;AAChB;AASA;;;;;;;;AAGO,eAAe,kBAAkB,GAAG,EAAE,YAAY;IACvD,IAAI,CAAC,KAAK,MAAM,IAAI,MAAM;IAE1B,MAAM,YAAY,IAAA,wJAAU,EAAC,8GAAE,EAAE;IAEjC,MAAM,UAAU;QACd,QAAQ;QACR,OAAO,MAAM,OAAO,CAAC,aAAa,KAAK,IAAI,aAAa,KAAK,GAAG,EAAE;QAClE,OAAO,aAAa,KAAK,IAAI;QAC7B,mBAAmB,aAAa,iBAAiB,IAAI;QACrD,QAAQ;QACR,WAAW,IAAA,6JAAe;IAC5B;IAEA,MAAM,MAAM,MAAM,IAAA,oJAAM,EAAC,WAAW;IACpC,OAAO;QAAE,IAAI,IAAI,EAAE;QAAE,MAAM;IAAQ;AACrC;AAGO,eAAe,mBAAmB,GAAG;IAC1C,IAAI,CAAC,KAAK,OAAO,EAAE;IAEnB,MAAM,IAAI,IAAA,mJAAK,EACb,IAAA,wJAAU,EAAC,8GAAE,EAAE,WACf,IAAA,mJAAK,EAAC,UAAU,MAAM,MACtB,IAAA,qJAAO,EAAC,aAAa;IAGvB,MAAM,QAAQ,MAAM,IAAA,qJAAO,EAAC;IAC5B,OAAO,MAAM,IAAI,CAAC,GAAG,CAAC,CAAC,IAAM,CAAC;YAAE,IAAI,EAAE,EAAE;YAAE,MAAM,EAAE,IAAI;QAAG,CAAC;AAC5D"}},
    {"offset": {"line": 55, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Vanshika/Desktop/Ecocart/pages/orders.js"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\r\nimport { AuthContext } from \"./_app\";\r\nimport { fetchOrdersForUser } from \"../lib/orders\";\r\nimport Link from \"next/link\";\r\n\r\nexport default function OrdersPage() {\r\n  const { user } = useContext(AuthContext);\r\n  const [orders, setOrders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    fetchOrdersForUser(user.uid)\r\n      .then((rows) => {\r\n        // fetchOrdersForUser returns [{id, data}], normalize to {id, ...data}\r\n        const normalized = rows.map((r) => ({ id: r.id, ...(r.data || {}) }));\r\n        setOrders(normalized);\r\n      })\r\n      .finally(() => setLoading(false));\r\n  }, [user]);\r\n\r\n  if (!user)\r\n    return (\r\n      <div className=\"p-8 max-w-3xl mx-auto\">\r\n        Please{\" \"}\r\n        <Link href=\"/auth\" className=\"text-green-600\">\r\n          sign in\r\n        </Link>{\" \"}\r\n        to see your orders.\r\n      </div>\r\n    );\r\n\r\n  if (loading) return <div className=\"p-8\">Loading...</div>;\r\n\r\n  if (!orders.length)\r\n    return (\r\n      <div className=\"p-8 max-w-3xl mx-auto text-center\">\r\n        <div className=\"text-lg font-medium\">No orders yet.</div>\r\n        <Link href=\"/shop\" className=\"mt-3 inline-block text-green-600\">\r\n          Start shopping\r\n        </Link>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-8 space-y-6\">\r\n      <h2 className=\"text-2xl font-semibold\">Your Orders</h2>\r\n\r\n      {orders.map((o) => {\r\n        const date = o.createdAt?.toDate\r\n          ? o.createdAt.toDate()\r\n          : o.createdAt instanceof Date\r\n          ? o.createdAt\r\n          : null;\r\n        const dateStr = date ? date.toLocaleString() : \"\";\r\n\r\n        const statusColor =\r\n          o.status === \"placed\"\r\n            ? \"bg-yellow-100 text-yellow-800\"\r\n            : o.status === \"shipped\"\r\n            ? \"bg-blue-100 text-blue-800\"\r\n            : o.status === \"delivered\"\r\n            ? \"bg-green-100 text-green-800\"\r\n            : \"bg-gray-100 text-gray-800\";\r\n\r\n        return (\r\n          <div key={o.id} className=\"p-4 bg-white rounded-lg shadow\">\r\n            <div className=\"flex flex-col md:flex-row md:items-center md:justify-between\">\r\n              <div className=\"flex items-center gap-4\">\r\n                <div className=\"text-sm text-gray-500\">Order #{o.id}</div>\r\n                <div className=\"text-sm text-gray-500\">{dateStr}</div>\r\n                <div\r\n                  className={`px-2 py-1 rounded text-xs font-medium ${statusColor}`}\r\n                >\r\n                  {o.status}\r\n                </div>\r\n              </div>\r\n              <div className=\"mt-3 md:mt-0 text-right\">\r\n                <div className=\"text-sm text-gray-500\">\r\n                  Items: {Array.isArray(o.items) ? o.items.length : 0}\r\n                </div>\r\n                <div className=\"text-lg font-semibold\">₹{o.total}</div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4\">\r\n              {(Array.isArray(o.items) ? o.items : []).map((it, i) => (\r\n                <div key={i} className=\"flex flex-col items-start gap-2\">\r\n                  <img\r\n                    src={it.image}\r\n                    alt={it.name}\r\n                    className=\"w-full h-28 object-cover rounded-md\"\r\n                  />\r\n                  <div className=\"text-sm font-medium\">{it.name}</div>\r\n                  <div className=\"text-xs text-gray-500\">\r\n                    Qty: {it.qty || 1}\r\n                  </div>\r\n                  <div className=\"text-sm font-semibold\">₹{it.price}</div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;;;;;;AAEe,SAAS;IACtB,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,iHAAU,EAAC,qHAAW;IACvC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,+GAAQ,EAAC,EAAE;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,+GAAQ,EAAC;IAEvC,IAAA,gHAAS,EAAC;QACR,IAAI,CAAC,MAAM;YACT,WAAW;YACX;QACF;QACA,IAAA,4HAAkB,EAAC,KAAK,GAAG,EACxB,IAAI,CAAC,CAAC;YACL,sEAAsE;YACtE,MAAM,aAAa,KAAK,GAAG,CAAC,CAAC,IAAM,CAAC;oBAAE,IAAI,EAAE,EAAE;oBAAE,GAAI,EAAE,IAAI,IAAI,CAAC,CAAC;gBAAE,CAAC;YACnE,UAAU;QACZ,GACC,OAAO,CAAC,IAAM,WAAW;IAC9B,GAAG;QAAC;KAAK;IAET,IAAI,CAAC,MACH,qBACE,qKAAC;QAAI,WAAU;;YAAwB;YAC9B;0BACP,qKAAC,gIAAI;gBAAC,MAAK;gBAAQ,WAAU;0BAAiB;;;;;;YAEtC;YAAI;;;;;;;IAKlB,IAAI,SAAS,qBAAO,qKAAC;QAAI,WAAU;kBAAM;;;;;;IAEzC,IAAI,CAAC,OAAO,MAAM,EAChB,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAI,WAAU;0BAAsB;;;;;;0BACrC,qKAAC,gIAAI;gBAAC,MAAK;gBAAQ,WAAU;0BAAmC;;;;;;;;;;;;IAMtE,qBACE,qKAAC;QAAI,WAAU;;0BACb,qKAAC;gBAAG,WAAU;0BAAyB;;;;;;YAEtC,OAAO,GAAG,CAAC,CAAC;gBACX,MAAM,OAAO,EAAE,SAAS,EAAE,SACtB,EAAE,SAAS,CAAC,MAAM,KAClB,EAAE,SAAS,YAAY,OACvB,EAAE,SAAS,GACX;gBACJ,MAAM,UAAU,OAAO,KAAK,cAAc,KAAK;gBAE/C,MAAM,cACJ,EAAE,MAAM,KAAK,WACT,kCACA,EAAE,MAAM,KAAK,YACb,8BACA,EAAE,MAAM,KAAK,cACb,gCACA;gBAEN,qBACE,qKAAC;oBAAe,WAAU;;sCACxB,qKAAC;4BAAI,WAAU;;8CACb,qKAAC;oCAAI,WAAU;;sDACb,qKAAC;4CAAI,WAAU;;gDAAwB;gDAAQ,EAAE,EAAE;;;;;;;sDACnD,qKAAC;4CAAI,WAAU;sDAAyB;;;;;;sDACxC,qKAAC;4CACC,WAAW,CAAC,sCAAsC,EAAE,aAAa;sDAEhE,EAAE,MAAM;;;;;;;;;;;;8CAGb,qKAAC;oCAAI,WAAU;;sDACb,qKAAC;4CAAI,WAAU;;gDAAwB;gDAC7B,MAAM,OAAO,CAAC,EAAE,KAAK,IAAI,EAAE,KAAK,CAAC,MAAM,GAAG;;;;;;;sDAEpD,qKAAC;4CAAI,WAAU;;gDAAwB;gDAAE,EAAE,KAAK;;;;;;;;;;;;;;;;;;;sCAIpD,qKAAC;4BAAI,WAAU;sCACZ,CAAC,MAAM,OAAO,CAAC,EAAE,KAAK,IAAI,EAAE,KAAK,GAAG,EAAE,EAAE,GAAG,CAAC,CAAC,IAAI,kBAChD,qKAAC;oCAAY,WAAU;;sDACrB,qKAAC;4CACC,KAAK,GAAG,KAAK;4CACb,KAAK,GAAG,IAAI;4CACZ,WAAU;;;;;;sDAEZ,qKAAC;4CAAI,WAAU;sDAAuB,GAAG,IAAI;;;;;;sDAC7C,qKAAC;4CAAI,WAAU;;gDAAwB;gDAC/B,GAAG,GAAG,IAAI;;;;;;;sDAElB,qKAAC;4CAAI,WAAU;;gDAAwB;gDAAE,GAAG,KAAK;;;;;;;;mCAVzC;;;;;;;;;;;mBArBN,EAAE,EAAE;;;;;YAqClB;;;;;;;AAGN"}}]
}